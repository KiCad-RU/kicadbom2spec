================================================================================
 Описание
================================================================================
Скрипт создает файл спецификации в виде таблицы *.ods в формате Open Document
Format, оформленной согласно требованиям ЕСКД, используя файл перечня элементов.
Скрипт предназначен для работы с САПР KiCAD, но может работать и с BOM файлами
полученными из других программ, если они оформлены согласно п. 4.

--------------------------------------------------------------------------------
 1. Файлы
--------------------------------------------------------------------------------
bom2spec.py - скрипт на языке python
COPYNG      - лицензионное соглашение
pattern.ods - шаблон таблиц спецификации
README      - файл, который вы сейчас читаете

--------------------------------------------------------------------------------
 2. Требования
--------------------------------------------------------------------------------
Для работы скрипта необходимы следующие элементы :
* python 2      http://www.python.org/
* odfpy         https://pypi.python.org/pypi/odfpy
· opengostfont  https://bitbucket.org/fat_angel/opengostfont
· LibreOffice   http://www.libreoffice.org/

Примечание: * - обязательные элементы; · - рекомендуемые элементы

--------------------------------------------------------------------------------
 3. Параметры
--------------------------------------------------------------------------------
Форма вызова:
python bom2spec.py [-h] [-o OUTPUT] [-s SCHEMATIC] [-v] bom

Обязательные параметры:

bom
    Полное или относительное (относительно скрипта) имя BOM файла.
    Примеры:
    ../../dir/projectName.csv
    /home/user/prj/bom.csv
    D:\Projects\myProject\myProject.csv

Дополнительные параметры:

-h, --help
    Получить помощь по работе со скриптом.

-o OUTPUT, --output OUTPUT
    Имя файла спецификации. По умолчанию файл спецификации будет сохранен под
    таким же именем и в той же директории что и BOM файл. Параметр применяется
    когда для спецификации необходимо задать особое имя.

-s SCHEMATIC, --schematic SCHEMATIC
    Имя файла схемы в формате KiCAD. Задается имя (с расширением) в том случае
    если оно отличается от имени BOM файла. Файл схемы необходим для получения
    данных из основной надписи и дальнейшего занесения их в спецификацию.

-v, --verbose
    Выводит в консоль подробную информации о ходе выполнения скрипта.

--------------------------------------------------------------------------------
 4. Формат BOM
--------------------------------------------------------------------------------
Для того, чтобы сгенерировать спецификацию должным образом необходимо правильно
составить перечень элементов. Для этого нужно настроить редактор схем EEschema
следующим образом:

1) сперва нужно определить несколько пользовательских полей для элементов. Для
этого открываем диалог настроек выбрав в меню "Настройки→Параметры" и во
вкладке "Шаблон имен полей" заполняем поля:

Пользовательское поле 1: Группа
Пользовательское поле 2: Марка
Пользовательское поле 3: Класс точности
Пользовательское поле 4: Тип
Пользовательское поле 5: Стандарт
Пользовательское поле 6: Примечание

Пользовательские поля 7 и 8 могут быть использованы по усмотрению пользователя,
при создании спецификации используются только первые шесть полей, остальные
игнорируются.

Из пользовательских полей 2...5 и поля элемента "Значение" формируется
наименование элемента. Элементы имеющие одинаковые значения поля "Группа" будут
объединены в одну группу с указанным названием. Значение поля "Примечание"
помещается в одноименную графу спецификации.

Рассмотрим пример образования одной строки спецификации:

┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━┳━━━━━━━━━━━━━━┓
┃Поз. обоз-┃                 Наименование                  ┃Кол.┃  Примечание  ┃
┃ начение  ┃                                               ┃    ┃              ┃
┠──────────╂───────────────────────────────────────────────╂────╂──────────────┨
┋          ┋                                               ┋    ┋              ┋
┠──────────╂───────────────────────────────────────────────╂────╂──────────────┨
┃          ┃                  Резисторы                    ┃    ┃              ┃
┠──────────╂───────────────────────────────────────────────╂────╂──────────────┨
┃          ┃                                               ┃    ┃              ┃
┠──────────╂───────────────────────────────────────────────╂────╂──────────────┨
┃    R1    ┃ МЛТ-0,25-1,8кОм±5%-В ОЖ0.467.18               ┃  1 ┃  1...2,8кОм  ┃
┠──────────╂───────────────────────────────────────────────╂────╂──────────────┨
┋          ┋                                               ┋    ┋              ┋

ЗНАЧЕНИЕ В СПЕЦИФИКАЦИИ:        ПОЛЕ ЭЛЕМЕНТА:
Резисторы                       Группа
R1                              Обозначение
МЛТ-0,25-                       Марка
1,8к                            Значение¹
±5%                             Класс точности
-В                              Тип
 ОЖ0.467.18                     Стандарт²
1...2,8кОм                      Примечание

Примечания:
1. Единицы измерения (в данном случае "Ом") добавляются автоматически для
резисторов, конденсаторов и индуктивностей если они отсутствуют.
2. Стандарт указан с пробелом в начале. При образовании наименования разделители
не используются, поэтому их нужно указывать в значениях полей.

Если какое-нибудь поле не нужно - его оставляют пустым. Количество элементов
подсчитывается автоматически. Если имеется несколько одинаковых элементов идущих
подряд, они сводятся в одну строку с указанием общего количества.

2) после заполнения полей элементов и завершения работы над схемой можно создать
список элементов. Для этого необходимо нажать на панели инструментов кнопку
"Сформировать перечень элементов и материалов" или выбрать в меню "Инструменты→
Сформировать перечень элементов". В появившемся диалоговом окне нужно задать
следующие параметры:

Формат вывода:
    Импорт в эл.таблицу (по обозн.)

Разделитель полей для импорта в эл.таблицу:
    Tab

Добавить в список:
    Обозначение
    Поля пользователя 1...6 (можно выбрать "Все поля пользователя")

Создать перечень элементов нажав кнопку "ОК" диалогового окна.

Созданный таким образом перечень элементов можно использовать для генерации
спецификации.
================================================================================
